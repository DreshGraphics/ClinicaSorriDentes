/*Criando a base de dados*/
CREATE DATABASE clinica_sorridentes_database;

/*Acessando a base criada*/
USE clinica_sorridentes_database;

/*Criação das tabelas na base de dados*/
CREATE TABLE USUARIO(
    IDUSUARIO INT PRIMARY KEY AUTO_INCREMENT,
    NOME VARCHAR(255) NOT NULL,
    LOGIN VARCHAR(50) NOT NULL UNIQUE,
    SENHA VARCHAR(50) NOT NULL
);

CREATE TABLE PACIENTE(
    IDPACIENTE INT PRIMARY KEY AUTO_INCREMENT,
    NOME VARCHAR(255) NOT NULL,
    SEXO ENUM('Masculino','Feminino') NOT NULL,
    NASCIMENTO DATE NOT NULL,
    CPF VARCHAR(14) NOT NULL,
    PROFISSAO VARCHAR(255) NOT NULL,
    TIPOATENDIMENTO VARCHAR(255) NOT NULL,
    CELULAR VARCHAR(15) NOT NULL,
    ESTADOCIVIL ENUM('Casado(a)','Solteiro(a)','Divorciado(a)','Viúvo(a)','Separado(a)')NOT NULL,
    ENDERECO VARCHAR(255) NOT NULL,
    BAIRRO VARCHAR(255) NOT NULL,
    NUMERO VARCHAR(4) NOT NULL,
    CIDADE VARCHAR(32) NOT NULL,
    ESTADO CHAR(2) NOT NULL,
    COMPLEMENTO VARCHAR(50),
    CEP VARCHAR(9) NOT NULL
);

CREATE TABLE FICHA_CLINICA(
    IDFICHACLINICA INT PRIMARY KEY AUTO_INCREMENT,
    DATA_FICHA DATETIME NOT NULL,
    OBSERVACOES VARCHAR(255),
    ID_PACIENTE INT
);

CREATE TABLE PROCEDIMENTO(
    IDPROCEDIMENTO INT PRIMARY KEY AUTO_INCREMENT,
    PROCEDIMENTO VARCHAR(255) NOT NULL,
    NUMERO_DENTE SMALLINT(2) NOT NULL,
    IMPORTANCIA ENUM("BAIXA IMPORTANCIA", "MEDIA IMPORTANCIA", "ALTA IMPORTANCIA") NOT NULL,
    VALORUNITARIO DECIMAL(10,2) NOT NULL,
    ORCAMENTO_FINAL DECIMAL(10,2) NOT NULL,
    DATA timestamp default current_timestamp() NOT NULL,
    ID_PACIENTE INT
);

CREATE TABLE MEDICO(
    IDMEDICO INT(11) PRIMARY KEY AUTO_INCREMENT,
    NOME VARCHAR(255) NOT NULL,
    TELEFONE VARCHAR(15) NOT NULL,
    EMAIL VARCHAR(255) NOT NULL UNIQUE,
    NASCIMENTO DATE NOT NULL,
    CONSELHO VARCHAR(255) NOT NULL,
    ESPECIALIDADE VARCHAR(255) NOT NULL,
    FUNCAO VARCHAR(255) NOT NULL,
    TIPOATENDIMENTO VARCHAR(255) NOT NULL
);

/*Criação das constraints nomeadas*/
ALTER TABLE FICHA_CLINICA ADD CONSTRAINT FK_FICHACLINICA_PACIENTE
FOREIGN KEY FICHA_CLINICA(ID_PACIENTE) REFERENCES PACIENTE(IDPACIENTE);

ALTER TABLE PROCEDIMENTO ADD CONSTRAINT FK_DENTES_PACIENTE
FOREIGN KEY PROCEDIMENTO(ID_PACIENTE) REFERENCES PACIENTE(IDPACIENTE);

/*Inserção do usuário padrão*/
INSERT INTO USUARIO(NOME, LOGIN, SENHA, TIPOUSUARIO) VALUES 
("Admin","admin","21232f297a57a5a743894a0e4a801fc3","Administrador");